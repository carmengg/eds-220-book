<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>EDS 220 - Working with Environmental Datasets - 23&nbsp; Raster manipulation II</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../discussion-sections/ds4-landcover.html" rel="next">
<link href="../lectures/lesson-19-dem.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../lectures/lesson-17-rioxarray.html">Raster data</a></li><li class="breadcrumb-item"><a href="../lectures/lesson-20-zonal-stats.html"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Raster manipulation II</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../">EDS 220 - Working with Environmental Datasets</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Welcome!</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lectures/lesson-0-create-conda-env.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Environment setup</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lectures/lesson-1-python-review.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Python Review</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Tabular data</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lectures/lesson-2-series-dataframes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title"><code>pandas</code></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../discussion-sections/ds1-anthr-prelim-data-exploration.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">* Lab: Preliminary data exploration</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lectures/lesson-3-pandas-subsetting.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Subsetting</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lectures/lesson-4-basic-plotting.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Plotting</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lectures/lesson-5-updating-dataframes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Updating data frames</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lectures/lesson-6-groupby.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title"><code>groupby()</code></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../discussion-sections/ds2-hares.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">* Lab: Data cleaning</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lectures/lesson-7-time-series.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Basic time series</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">Vector data</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lectures/lesson-8-vector-data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Data formats</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lectures/lesson-11-crs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Coordinate Reference Systems</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lectures/lesson-9-geopandas-intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title"><code>geopandas</code></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lectures/lesson-10-merge-data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Merging data</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lectures/lesson-12-csv-to-geo.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">csv to <code>GeoDataFrame</code></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lectures/lesson-13-reproject-and-clip.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Reprojecting &amp; Clipping</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../discussion-sections/ds3-earthquakes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">*Lab: Maps</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lectures/lesson-21-contextily-parquet.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Parquet and contextily</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
 <span class="menu-text">Multi-dimensional data</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lectures/lesson-14-multidimensional-data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">NetCDF</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lectures/lesson-15-xarray.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title"><code>xarray</code></span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
 <span class="menu-text">Raster data</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lectures/lesson-17-rioxarray.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title"><code>rioxarray</code></span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lectures/lesson-19-dem.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Raster manipulation I</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lectures/lesson-20-zonal-stats.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Raster manipulation II</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../discussion-sections/ds4-landcover.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">*Lab: land cover statistics</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lectures/lesson-18-STAC.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">STAC specification</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../discussion-sections/ds5-modis-ndvi.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">*Lab: STAC access</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lectures/lesson-22-make_a_gif.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Make a GIF</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../appendices/set-pat.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Setting a PAT</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../appendices/gitignore_untrack.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">Gitignore &amp; Git Untracking</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../appendices/undoing-commit.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">C</span>&nbsp; <span class="chapter-title">Undoing commits</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#data" id="toc-data" class="nav-link active" data-scroll-target="#data"><span class="header-section-number">23.1</span> Data</a></li>
  <li><a href="#import-data" id="toc-import-data" class="nav-link" data-scroll-target="#import-data"><span class="header-section-number">23.2</span> Import data</a></li>
  <li><a href="#fishing-areas-preparation" id="toc-fishing-areas-preparation" class="nav-link" data-scroll-target="#fishing-areas-preparation"><span class="header-section-number">23.3</span> Fishing areas preparation</a>
  <ul class="collapse">
  <li><a href="#update-column-names-and-crs" id="toc-update-column-names-and-crs" class="nav-link" data-scroll-target="#update-column-names-and-crs"><span class="header-section-number">23.3.1</span> Update column names and CRS</a></li>
  <li><a href="#data-selection" id="toc-data-selection" class="nav-link" data-scroll-target="#data-selection"><span class="header-section-number">23.3.2</span> Data selection</a></li>
  <li><a href="#plot-of-kodiak-fisihing-area" id="toc-plot-of-kodiak-fisihing-area" class="nav-link" data-scroll-target="#plot-of-kodiak-fisihing-area"><span class="header-section-number">23.3.3</span> Plot of Kodiak fisihing area</a></li>
  <li><a href="#dissolve-explode-polygons" id="toc-dissolve-explode-polygons" class="nav-link" data-scroll-target="#dissolve-explode-polygons"><span class="header-section-number">23.3.4</span> Dissolve &amp; explode polygons</a></li>
  </ul></li>
  <li><a href="#distance-raster-preparation" id="toc-distance-raster-preparation" class="nav-link" data-scroll-target="#distance-raster-preparation"><span class="header-section-number">23.4</span> Distance raster preparation</a>
  <ul class="collapse">
  <li><a href="#squeeze" id="toc-squeeze" class="nav-link" data-scroll-target="#squeeze"><span class="header-section-number">23.4.1</span> Squeeze</a></li>
  <li><a href="#updating-no-data-value" id="toc-updating-no-data-value" class="nav-link" data-scroll-target="#updating-no-data-value"><span class="header-section-number">23.4.2</span> Updating no-data value</a></li>
  <li><a href="#clipping" id="toc-clipping" class="nav-link" data-scroll-target="#clipping"><span class="header-section-number">23.4.3</span> Clipping</a></li>
  </ul></li>
  <li><a href="#distance-in-a-single-district" id="toc-distance-in-a-single-district" class="nav-link" data-scroll-target="#distance-in-a-single-district"><span class="header-section-number">23.5</span> Distance in a single district</a></li>
  <li><a href="#distance-in-all-districts" id="toc-distance-in-all-districts" class="nav-link" data-scroll-target="#distance-in-all-districts"><span class="header-section-number">23.6</span> Distance in all districts</a></li>
  <li><a href="#acknowledgments" id="toc-acknowledgments" class="nav-link" data-scroll-target="#acknowledgments"><span class="header-section-number">23.7</span> Acknowledgments</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Raster manipulation II</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p>In this lesson we will learn how to select pixels in a raster by creating a mask from a polygon. The goal will be to calculate total number of meters of vessel tracks within the fishing districts of the Kodiak fishing registration area in Alaska.</p>
<section id="data" class="level2" data-number="23.1">
<h2 data-number="23.1" class="anchored" data-anchor-id="data"><span class="header-section-number">23.1</span> Data</h2>
<p>We will use three datsets about Alaska in this lesson.</p>
<p><strong>Dataset 1</strong></p>
<p>This is a raster dataset at 1km/pixel resolution showing shipping intensity in the Pacific Arctic region during August 2017. The value at each raster cell represents the total length, in meters, of all vessel tracks within each cell. The dataset is part of time series of shipping intensity monthly and the complete datset can be accessed at: <a href="https://arcticdata.io/catalog/view/doi:10.18739/A2SQ8QJ9S">https://arcticdata.io/catalog/view/doi:10.18739/A2SQ8QJ9S</a>.</p>
<p><strong>Dataset 2</strong></p>
<p>Vector data showing statistical areas dividing waters of the State of Alaska and the adjacent Exclusive Economic Zone (EEZ) into small units for the purpose of reporting and analyzing fishery harvest. The dataset is archived at KNB and can be accessed at the following link: <a href="https://knb.ecoinformatics.org/view/doi:10.5063/F1QR4VJK">https://knb.ecoinformatics.org/view/doi:10.5063/F1QR4VJK</a>.</p>
<p><strong>Dataset 3</strong></p>
<p>A polygon showing Alaska’s boundary extracted from the 2022 US Census TIGER shapefiles and with updated CRS.</p>
</section>
<section id="import-data" class="level2" data-number="23.2">
<h2 data-number="23.2" class="anchored" data-anchor-id="import-data"><span class="header-section-number">23.2</span> Import data</h2>
<p>Let’s start by importing the necessary libraries and functions:</p>
<div class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.patches <span class="im">as</span> mpatches <span class="co"># for creating legends</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> xarray <span class="im">as</span> xr</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> rioxarray <span class="im">as</span> rioxr</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> geopandas <span class="im">as</span> gpd</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> rasterio.features <span class="im">import</span> rasterize <span class="co"># for rasterizing polygons</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="co"># -----------</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="co"># update pandas column display</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>pd.set_option(<span class="st">'display.max_columns'</span>, <span class="va">None</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># open raster</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>raw_dist <span class="op">=</span> rioxr.open_rasterio(<span class="st">'https://arcticdata.io/metacat/d1/mn/v2/object/urn%3Auuid%3A0d223f34-77fc-4ebe-8a58-459b7e575668'</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>raw_dist</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="2">

<div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewbox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewbox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class="xr-text-repr-fallback">&lt;xarray.DataArray (band: 1, y: 2308, x: 3087)&gt;
[7124796 values with dtype=float32]
Coordinates:
  * band         (band) int64 1
  * x            (x) float64 -2.55e+06 -2.549e+06 ... 5.347e+05 5.357e+05
  * y            (y) float64 2.711e+06 2.71e+06 ... 4.053e+05 4.043e+05
    spatial_ref  int64 0
Attributes:
    AREA_OR_POINT:       Area
    STATISTICS_MAXIMUM:  2564975.75
    STATISTICS_MEAN:     nan
    STATISTICS_MINIMUM:  0
    STATISTICS_STDDEV:   nan
    _FillValue:          -3.4e+38
    scale_factor:        1.0
    add_offset:          0.0</pre><div class="xr-wrap" style="display:none"><div class="xr-header"><div class="xr-obj-type">xarray.DataArray</div><div class="xr-array-name"></div><ul class="xr-dim-list"><li><span class="xr-has-index">band</span>: 1</li><li><span class="xr-has-index">y</span>: 2308</li><li><span class="xr-has-index">x</span>: 3087</li></ul></div><ul class="xr-sections"><li class="xr-section-item"><div class="xr-array-wrap"><input id="section-a42f6312-acfd-4037-8889-13fc153136dd" class="xr-array-in" type="checkbox" checked=""><label for="section-a42f6312-acfd-4037-8889-13fc153136dd" title="Show/hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-array-preview xr-preview"><span>...</span></div><div class="xr-array-data"><pre>[7124796 values with dtype=float32]</pre></div></div></li><li class="xr-section-item"><input id="section-2751fbcc-5759-4fbd-8635-a473479c71c8" class="xr-section-summary-in" type="checkbox" checked=""><label for="section-2751fbcc-5759-4fbd-8635-a473479c71c8" class="xr-section-summary">Coordinates: <span>(4)</span></label><div class="xr-section-inline-details"></div><div class="xr-section-details"><ul class="xr-var-list"><li class="xr-var-item"><div class="xr-var-name"><span class="xr-has-index">band</span></div><div class="xr-var-dims">(band)</div><div class="xr-var-dtype">int64</div><div class="xr-var-preview xr-preview">1</div><input id="attrs-4ed8cf3a-28bd-408c-a2d6-6ff005d0567e" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-4ed8cf3a-28bd-408c-a2d6-6ff005d0567e" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-41ea6d96-f1ee-4743-9c46-748bc744586e" class="xr-var-data-in" type="checkbox"><label for="data-41ea6d96-f1ee-4743-9c46-748bc744586e" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([1])</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span class="xr-has-index">x</span></div><div class="xr-var-dims">(x)</div><div class="xr-var-dtype">float64</div><div class="xr-var-preview xr-preview">-2.55e+06 -2.549e+06 ... 5.357e+05</div><input id="attrs-bfa64e5c-46a7-41d7-ad07-88c73ff70111" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-bfa64e5c-46a7-41d7-ad07-88c73ff70111" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-914cde88-87f2-4211-b58f-bed9b18daa9f" class="xr-var-data-in" type="checkbox"><label for="data-914cde88-87f2-4211-b58f-bed9b18daa9f" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([-2549653.392631, -2548653.593215, -2547653.7938  , ...,   533728.004297,
         534727.803712,   535727.603128])</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span class="xr-has-index">y</span></div><div class="xr-var-dims">(y)</div><div class="xr-var-dtype">float64</div><div class="xr-var-preview xr-preview">2.711e+06 2.71e+06 ... 4.043e+05</div><input id="attrs-69ae1373-2cc8-4f0b-ace6-fc66908b673d" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-69ae1373-2cc8-4f0b-ace6-fc66908b673d" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-7754e086-c6d4-48ce-ba49-c9a43d33a487" class="xr-var-data-in" type="checkbox"><label for="data-7754e086-c6d4-48ce-ba49-c9a43d33a487" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([2711203.120224, 2710203.151455, 2709203.182686, ...,  406275.10722 ,
        405275.138451,  404275.169682])</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span>spatial_ref</span></div><div class="xr-var-dims">()</div><div class="xr-var-dtype">int64</div><div class="xr-var-preview xr-preview">0</div><input id="attrs-2805c162-fd3a-4e3e-a22f-9fd205e5808c" class="xr-var-attrs-in" type="checkbox"><label for="attrs-2805c162-fd3a-4e3e-a22f-9fd205e5808c" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-d6159604-ab9d-42b9-b9e8-8dded0a91cb0" class="xr-var-data-in" type="checkbox"><label for="data-d6159604-ab9d-42b9-b9e8-8dded0a91cb0" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"><dt><span>crs_wkt :</span></dt><dd>PROJCS["unnamed",GEOGCS["NAD83",DATUM["North_American_Datum_1983",SPHEROID["GRS 1980",6378137,298.257222101004,AUTHORITY["EPSG","7019"]],AUTHORITY["EPSG","6269"]],PRIMEM["Greenwich",0],UNIT["degree",0.0174532925199433,AUTHORITY["EPSG","9122"]],AUTHORITY["EPSG","4269"]],PROJECTION["Albers_Conic_Equal_Area"],PARAMETER["latitude_of_center",50],PARAMETER["longitude_of_center",-154],PARAMETER["standard_parallel_1",55],PARAMETER["standard_parallel_2",65],PARAMETER["false_easting",0],PARAMETER["false_northing",0],UNIT["metre",1,AUTHORITY["EPSG","9001"]],AXIS["Easting",EAST],AXIS["Northing",NORTH]]</dd><dt><span>semi_major_axis :</span></dt><dd>6378137.0</dd><dt><span>semi_minor_axis :</span></dt><dd>6356752.314140356</dd><dt><span>inverse_flattening :</span></dt><dd>298.257222101004</dd><dt><span>reference_ellipsoid_name :</span></dt><dd>GRS 1980</dd><dt><span>longitude_of_prime_meridian :</span></dt><dd>0.0</dd><dt><span>prime_meridian_name :</span></dt><dd>Greenwich</dd><dt><span>geographic_crs_name :</span></dt><dd>NAD83</dd><dt><span>horizontal_datum_name :</span></dt><dd>North American Datum 1983</dd><dt><span>projected_crs_name :</span></dt><dd>unnamed</dd><dt><span>grid_mapping_name :</span></dt><dd>albers_conical_equal_area</dd><dt><span>standard_parallel :</span></dt><dd>(55.0, 65.0)</dd><dt><span>latitude_of_projection_origin :</span></dt><dd>50.0</dd><dt><span>longitude_of_central_meridian :</span></dt><dd>-154.0</dd><dt><span>false_easting :</span></dt><dd>0.0</dd><dt><span>false_northing :</span></dt><dd>0.0</dd><dt><span>spatial_ref :</span></dt><dd>PROJCS["unnamed",GEOGCS["NAD83",DATUM["North_American_Datum_1983",SPHEROID["GRS 1980",6378137,298.257222101004,AUTHORITY["EPSG","7019"]],AUTHORITY["EPSG","6269"]],PRIMEM["Greenwich",0],UNIT["degree",0.0174532925199433,AUTHORITY["EPSG","9122"]],AUTHORITY["EPSG","4269"]],PROJECTION["Albers_Conic_Equal_Area"],PARAMETER["latitude_of_center",50],PARAMETER["longitude_of_center",-154],PARAMETER["standard_parallel_1",55],PARAMETER["standard_parallel_2",65],PARAMETER["false_easting",0],PARAMETER["false_northing",0],UNIT["metre",1,AUTHORITY["EPSG","9001"]],AXIS["Easting",EAST],AXIS["Northing",NORTH]]</dd><dt><span>GeoTransform :</span></dt><dd>-2550153.29233849 999.7994153462766 0.0 2711703.104608573 0.0 -999.9687691991521</dd></dl></div><div class="xr-var-data"><pre>array(0)</pre></div></li></ul></div></li><li class="xr-section-item"><input id="section-0e1e125d-d9e5-4ec1-a023-fde82ca33254" class="xr-section-summary-in" type="checkbox"><label for="section-0e1e125d-d9e5-4ec1-a023-fde82ca33254" class="xr-section-summary">Indexes: <span>(3)</span></label><div class="xr-section-inline-details"></div><div class="xr-section-details"><ul class="xr-var-list"><li class="xr-var-item"><div class="xr-index-name"><div>band</div></div><div class="xr-index-preview">PandasIndex</div><div></div><input id="index-d6d79b1d-c8d6-41d0-b166-b8a65711d94c" class="xr-index-data-in" type="checkbox"><label for="index-d6d79b1d-c8d6-41d0-b166-b8a65711d94c" title="Show/Hide index repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-index-data"><pre>PandasIndex(Index([1], dtype='int64', name='band'))</pre></div></li><li class="xr-var-item"><div class="xr-index-name"><div>x</div></div><div class="xr-index-preview">PandasIndex</div><div></div><input id="index-9cc8655b-d733-4f88-8baa-eed5da276e38" class="xr-index-data-in" type="checkbox"><label for="index-9cc8655b-d733-4f88-8baa-eed5da276e38" title="Show/Hide index repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-index-data"><pre>PandasIndex(Index([ -2549653.392630817, -2548653.5932154707, -2547653.7938001244,
        -2546653.994384778,  -2545654.194969432, -2544654.3955540857,
        -2543654.596138739,  -2542654.796723393, -2541654.9973080466,
       -2540655.1978927003,
       ...
         526729.4083896764,   527729.2078050226,   528729.0072203688,
         529728.8066357151,   530728.6060510613,   531728.4054664075,
         532728.2048817538,   533728.0042971005,   534727.8037124467,
          535727.603127793],
      dtype='float64', name='x', length=3087))</pre></div></li><li class="xr-var-item"><div class="xr-index-name"><div>y</div></div><div class="xr-index-preview">PandasIndex</div><div></div><input id="index-80025a71-0d44-4736-9043-5a0c1ed6eb86" class="xr-index-data-in" type="checkbox"><label for="index-80025a71-0d44-4736-9043-5a0c1ed6eb86" title="Show/Hide index repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-index-data"><pre>PandasIndex(Index([2711203.1202239734,  2710203.151454774,  2709203.182685575,
        2708203.213916376,  2707203.245147177,  2706203.276377978,
       2705203.3076087786, 2704203.3388395794,   2703203.37007038,
        2702203.401301181,
       ...
         413274.888604322, 412274.91983512277, 411274.95106592355,
       410274.98229672434,  409275.0135275251,  408275.0447583259,
        407275.0759891267, 406275.10721992794, 405275.13845072873,
        404275.1696815295],
      dtype='float64', name='y', length=2308))</pre></div></li></ul></div></li><li class="xr-section-item"><input id="section-2769f0c2-790f-4217-8a5d-89b29b626392" class="xr-section-summary-in" type="checkbox" checked=""><label for="section-2769f0c2-790f-4217-8a5d-89b29b626392" class="xr-section-summary">Attributes: <span>(8)</span></label><div class="xr-section-inline-details"></div><div class="xr-section-details"><dl class="xr-attrs"><dt><span>AREA_OR_POINT :</span></dt><dd>Area</dd><dt><span>STATISTICS_MAXIMUM :</span></dt><dd>2564975.75</dd><dt><span>STATISTICS_MEAN :</span></dt><dd>nan</dd><dt><span>STATISTICS_MINIMUM :</span></dt><dd>0</dd><dt><span>STATISTICS_STDDEV :</span></dt><dd>nan</dd><dt><span>_FillValue :</span></dt><dd>-3.4e+38</dd><dt><span>scale_factor :</span></dt><dd>1.0</dd><dt><span>add_offset :</span></dt><dd>0.0</dd></dl></div></li></ul></div></div>
</div>
</div>
<div class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># open fishing areas polygons</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>fishing_areas <span class="op">=</span> gpd.read_file(os.path.join(os.getcwd(), <span class="st">'data'</span>, <span class="st">'Alaska_Commercial_Salmon_Boundaries.gpkg'</span>))</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>fishing_areas.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="3">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">OBJECTID</th>
<th data-quarto-table-cell-role="th">GEOMETRY_START_DATE</th>
<th data-quarto-table-cell-role="th">GEOMETRY_END_DATE</th>
<th data-quarto-table-cell-role="th">STAT_AREA</th>
<th data-quarto-table-cell-role="th">STAT_AREA_NAME</th>
<th data-quarto-table-cell-role="th">FISHERY_GROUP_CODE</th>
<th data-quarto-table-cell-role="th">GIS_SERIES_NAME</th>
<th data-quarto-table-cell-role="th">GIS_SERIES_CODE</th>
<th data-quarto-table-cell-role="th">REGION_CODE</th>
<th data-quarto-table-cell-role="th">REGISTRATION_AREA_NAME</th>
<th data-quarto-table-cell-role="th">REGISTRATION_AREA_CODE</th>
<th data-quarto-table-cell-role="th">REGISTRATION_AREA_ID</th>
<th data-quarto-table-cell-role="th">REGISTRATION_LOCATION_ABBR</th>
<th data-quarto-table-cell-role="th">MANAGEMENT_AREA_NAME</th>
<th data-quarto-table-cell-role="th">MANAGEMENT_AREA_CODE</th>
<th data-quarto-table-cell-role="th">DISTRICT_NAME</th>
<th data-quarto-table-cell-role="th">DISTRICT_CODE</th>
<th data-quarto-table-cell-role="th">DISTRICT_ID</th>
<th data-quarto-table-cell-role="th">SUBDISTRICT_NAME</th>
<th data-quarto-table-cell-role="th">SUBDISTRICT_CODE</th>
<th data-quarto-table-cell-role="th">SUBDISTRICT_ID</th>
<th data-quarto-table-cell-role="th">SECTION_NAME</th>
<th data-quarto-table-cell-role="th">SECTION_CODE</th>
<th data-quarto-table-cell-role="th">SECTION_ID</th>
<th data-quarto-table-cell-role="th">SUBSECTION_NAME</th>
<th data-quarto-table-cell-role="th">SUBSECTION_CODE</th>
<th data-quarto-table-cell-role="th">SUBSECTION_ID</th>
<th data-quarto-table-cell-role="th">COAR_AREA_CODE</th>
<th data-quarto-table-cell-role="th">CREATOR</th>
<th data-quarto-table-cell-role="th">CREATE_DATE</th>
<th data-quarto-table-cell-role="th">EDITOR</th>
<th data-quarto-table-cell-role="th">EDIT_DATE</th>
<th data-quarto-table-cell-role="th">COMMENTS</th>
<th data-quarto-table-cell-role="th">STAT_AREA_VERSION_ID</th>
<th data-quarto-table-cell-role="th">Shape_Length</th>
<th data-quarto-table-cell-role="th">Shape_Area</th>
<th data-quarto-table-cell-role="th">geometry</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>12</td>
<td>1975-01-01 00:00:00+00:00</td>
<td>NaT</td>
<td>33461</td>
<td>Tanana River mouth to Kantishna River</td>
<td>B</td>
<td>Salmon</td>
<td>B</td>
<td>3</td>
<td>Yukon Area</td>
<td>Y</td>
<td>None</td>
<td>None</td>
<td>Upper Yukon</td>
<td>YU</td>
<td>6 District</td>
<td>Y-6</td>
<td>None</td>
<td>6-A Subdistrict</td>
<td>6-A</td>
<td>None</td>
<td></td>
<td>None</td>
<td>NaN</td>
<td>None</td>
<td>None</td>
<td>None</td>
<td>YU</td>
<td>Evelyn Russel</td>
<td>2006-03-26 00:00:00+00:00</td>
<td>Sabrina Larsen</td>
<td>2017-02-02 00:00:00+00:00</td>
<td>Yukon District, 6 Subdistrict and 6-A Section ...</td>
<td>None</td>
<td>4.610183</td>
<td>0.381977</td>
<td>MULTIPOLYGON (((-151.32805 64.96913, -151.3150...</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>13</td>
<td>1975-01-01 00:00:00+00:00</td>
<td>NaT</td>
<td>33462</td>
<td>Kantishna River to Wood River</td>
<td>B</td>
<td>Salmon</td>
<td>B</td>
<td>3</td>
<td>Yukon Area</td>
<td>Y</td>
<td>None</td>
<td>None</td>
<td>Upper Yukon</td>
<td>YU</td>
<td>6 District</td>
<td>Y-6</td>
<td>None</td>
<td>6-B Subdistrict</td>
<td>6-B</td>
<td>None</td>
<td></td>
<td>None</td>
<td>NaN</td>
<td>None</td>
<td>None</td>
<td>None</td>
<td>YU</td>
<td>Evelyn Russel</td>
<td>2006-03-26 00:00:00+00:00</td>
<td>Sabrina Larsen</td>
<td>2017-02-02 00:00:00+00:00</td>
<td>Yukon District, 6 Subdistrict and 6-B Section ...</td>
<td>None</td>
<td>3.682421</td>
<td>0.321943</td>
<td>MULTIPOLYGON (((-149.96255 64.70518, -149.9666...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>18</td>
<td>1978-01-01 00:00:00+00:00</td>
<td>NaT</td>
<td>33431</td>
<td>Toklik to Cottonwood Point</td>
<td>B</td>
<td>Salmon</td>
<td>B</td>
<td>3</td>
<td>Yukon Area</td>
<td>Y</td>
<td>None</td>
<td>None</td>
<td>Lower Yukon</td>
<td>YL</td>
<td>3 District</td>
<td>Y-3</td>
<td>None</td>
<td></td>
<td>None</td>
<td>None</td>
<td>None</td>
<td>None</td>
<td>NaN</td>
<td>None</td>
<td>None</td>
<td>None</td>
<td>YL</td>
<td>Evelyn Russel</td>
<td>2006-03-26 00:00:00+00:00</td>
<td>Sabrina Larsen</td>
<td>2017-02-02 00:00:00+00:00</td>
<td>Yukon District and 3 Subdistrict until 1/1/1980</td>
<td>None</td>
<td>2.215641</td>
<td>0.198740</td>
<td>MULTIPOLYGON (((-161.39853 61.55463, -161.4171...</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>19</td>
<td>1980-01-01 00:00:00+00:00</td>
<td>NaT</td>
<td>33442</td>
<td>Right Bank, Bishop Rock to Illinois Creek</td>
<td>B</td>
<td>Salmon</td>
<td>B</td>
<td>3</td>
<td>Yukon Area</td>
<td>Y</td>
<td>None</td>
<td>None</td>
<td>Upper Yukon</td>
<td>YU</td>
<td>4 District</td>
<td>Y-4</td>
<td>None</td>
<td>4-B Subdistrict</td>
<td>4-B</td>
<td>None</td>
<td>None</td>
<td>None</td>
<td>NaN</td>
<td>None</td>
<td>None</td>
<td>None</td>
<td>YU</td>
<td>Evelyn Russel</td>
<td>2006-03-26 00:00:00+00:00</td>
<td>Sabrina Larsen</td>
<td>2017-02-02 00:00:00+00:00</td>
<td>None</td>
<td>None</td>
<td>9.179852</td>
<td>0.382788</td>
<td>MULTIPOLYGON (((-153.15234 65.24944, -153.0761...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>20</td>
<td>1980-01-01 00:00:00+00:00</td>
<td>NaT</td>
<td>33443</td>
<td>Left Bank, Cone Point to Illinois Creek</td>
<td>B</td>
<td>Salmon</td>
<td>B</td>
<td>3</td>
<td>Yukon Area</td>
<td>Y</td>
<td>None</td>
<td>None</td>
<td>Upper Yukon</td>
<td>YU</td>
<td>4 District</td>
<td>Y-4</td>
<td>None</td>
<td>4-B Subdistrict</td>
<td>4-B</td>
<td>None</td>
<td>None</td>
<td>None</td>
<td>NaN</td>
<td>None</td>
<td>None</td>
<td>None</td>
<td>YU</td>
<td>Evelyn Russel</td>
<td>2006-03-26 00:00:00+00:00</td>
<td>Sabrina Larsen</td>
<td>2017-02-02 00:00:00+00:00</td>
<td>None</td>
<td>None</td>
<td>9.500826</td>
<td>0.378262</td>
<td>MULTIPOLYGON (((-152.99905 65.17027, -152.9897...</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># open Alaska boundary</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>ak <span class="op">=</span> gpd.read_file(os.path.join(os.getcwd(), <span class="st">'data'</span>, <span class="st">'alaska_perimeter'</span>,<span class="st">'alaska_perimeter.shp'</span>))</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>ak</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="4">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">REGION</th>
<th data-quarto-table-cell-role="th">DIVISION</th>
<th data-quarto-table-cell-role="th">STATEFP</th>
<th data-quarto-table-cell-role="th">STATENS</th>
<th data-quarto-table-cell-role="th">GEOID</th>
<th data-quarto-table-cell-role="th">STUSPS</th>
<th data-quarto-table-cell-role="th">NAME</th>
<th data-quarto-table-cell-role="th">LSAD</th>
<th data-quarto-table-cell-role="th">MTFCC</th>
<th data-quarto-table-cell-role="th">FUNCSTAT</th>
<th data-quarto-table-cell-role="th">ALAND</th>
<th data-quarto-table-cell-role="th">AWATER</th>
<th data-quarto-table-cell-role="th">INTPTLAT</th>
<th data-quarto-table-cell-role="th">INTPTLON</th>
<th data-quarto-table-cell-role="th">geometry</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>4</td>
<td>9</td>
<td>02</td>
<td>01785533</td>
<td>02</td>
<td>AK</td>
<td>Alaska</td>
<td>00</td>
<td>G4000</td>
<td>A</td>
<td>1478943541175</td>
<td>245377731557</td>
<td>+63.3473560</td>
<td>-152.8397334</td>
<td>MULTIPOLYGON (((-1728945.561 474182.534, -1728...</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="fishing-areas-preparation" class="level2" data-number="23.3">
<h2 data-number="23.3" class="anchored" data-anchor-id="fishing-areas-preparation"><span class="header-section-number">23.3</span> Fishing areas preparation</h2>
<p>We need to do some processing of each dataset before combining them for analysis. Let’s start with the fishing areas.</p>
<section id="update-column-names-and-crs" class="level3" data-number="23.3.1">
<h3 data-number="23.3.1" class="anchored" data-anchor-id="update-column-names-and-crs"><span class="header-section-number">23.3.1</span> Update column names and CRS</h3>
<div class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># make column names small caps</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>fishing_areas.columns <span class="op">=</span> fishing_areas.columns.<span class="bu">str</span>.lower()</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(fishing_areas.columns, <span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="co"># -----------------------</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="co"># check CRS</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"raw_dist: </span><span class="sc">{</span>raw_dist<span class="sc">.</span>rio<span class="sc">.</span>crs<span class="sc">}</span><span class="ss"> </span><span class="ch">\n</span><span class="ss">ak: </span><span class="sc">{</span>ak<span class="sc">.</span>crs<span class="sc">}</span><span class="ss"> </span><span class="ch">\n</span><span class="ss">fishing_areas: </span><span class="sc">{</span>fishing_areas<span class="sc">.</span>crs<span class="sc">}</span><span class="ch">\n</span><span class="ss">"</span>)</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="co">#print(raw_dist.rio.crs == ak.crs)</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="co"># transform fishing_areas CRS to epsg:3338 (AK CRS)</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>fishing_areas <span class="op">=</span> fishing_areas.to_crs(ak.crs)</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'CRS match:'</span>, raw_dist.rio.crs <span class="op">==</span> fishing_areas.crs)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Index(['objectid', 'geometry_start_date', 'geometry_end_date', 'stat_area',
       'stat_area_name', 'fishery_group_code', 'gis_series_name',
       'gis_series_code', 'region_code', 'registration_area_name',
       'registration_area_code', 'registration_area_id',
       'registration_location_abbr', 'management_area_name',
       'management_area_code', 'district_name', 'district_code', 'district_id',
       'subdistrict_name', 'subdistrict_code', 'subdistrict_id',
       'section_name', 'section_code', 'section_id', 'subsection_name',
       'subsection_code', 'subsection_id', 'coar_area_code', 'creator',
       'create_date', 'editor', 'edit_date', 'comments',
       'stat_area_version_id', 'shape_length', 'shape_area', 'geometry'],
      dtype='object') 

raw_dist: EPSG:3338 
ak: EPSG:3338 
fishing_areas: EPSG:4326
</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>CRS match: True</code></pre>
</div>
</div>
</section>
<section id="data-selection" class="level3" data-number="23.3.2">
<h3 data-number="23.3.2" class="anchored" data-anchor-id="data-selection"><span class="header-section-number">23.3.2</span> Data selection</h3>
<p>This data includes fine scale subdivisions of the fishing areas. We’ll be working with data from the Kodiak registration area only, so let’s select that.</p>
<div class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Registration areas:</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(fishing_areas.registration_area_name.unique())</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="co"># select Kodiak area</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>kodiak <span class="op">=</span> fishing_areas[fishing_areas.registration_area_name <span class="op">==</span> <span class="st">'Kodiak Area'</span> ]</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'# geometries in Kodiak area:'</span>, <span class="bu">len</span>(kodiak) )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>['Yukon Area' 'Kuskokwim Area' 'Prince William Sound Area'
 'Bristol Bay Area' 'Chignik Area' 'Kodiak Area' 'Alaska Peninsula Area'
 'Cook Inlet Area' 'Norton Sound-Port Clarence Area'
 'Arctic-Kotzebue Area' 'Aleutian Islands Area' 'Atka-Amlia Islands Area'
 'Southeastern Alaska Area']
# geometries in Kodiak area: 118</code></pre>
</div>
</div>
</section>
<section id="plot-of-kodiak-fisihing-area" class="level3" data-number="23.3.3">
<h3 data-number="23.3.3" class="anchored" data-anchor-id="plot-of-kodiak-fisihing-area"><span class="header-section-number">23.3.3</span> Plot of Kodiak fisihing area</h3>
<p>One way to add a custom legend is to create an <code>Patch</code> object for each geometry in our plot.</p>
<p>We can create a <code>Patch</code> with a custom color and legend via the <code>mpatches.Patch()</code> function:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>great_patch <span class="op">=</span>  mpatches.Patch( color <span class="op">=</span> <span class="st">'great_color'</span>,</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>                               label <span class="op">=</span> <span class="st">'great_label'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>To add this patch to the legend we should first create an axis, for example by calling <code>fig, ax = plt.subplots()</code> at the beginning of our plot. Then we add <code>great_patch</code> to the legend:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>ax.legend(handles <span class="op">=</span> [great_patch])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><strong>Example:</strong></p>
<div class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create AK plot with color patches in legend</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots()</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="co"># --------------------------------------------</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>ak.plot(ax<span class="op">=</span>ax, color <span class="op">=</span> <span class="st">'pink'</span>)</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>ak_patch <span class="op">=</span> mpatches.Patch(color<span class="op">=</span><span class="st">'pink'</span>,</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>                          label<span class="op">=</span><span class="st">'Alaska, US'</span>)</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a><span class="co"># --------------------------------------------</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a><span class="co">#kodiak.dissolve().plot(ax=ax, color = 'blue')</span></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>kodiak.plot(ax<span class="op">=</span>ax, color <span class="op">=</span> <span class="st">'blue'</span>)</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>kodiak_patch <span class="op">=</span> mpatches.Patch(color<span class="op">=</span><span class="st">'blue'</span>,</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>                              label<span class="op">=</span><span class="st">'Kodiak fishing area'</span>)</span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a><span class="co"># ------------------------------------------</span></span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a><span class="co"># create elegend</span></span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>ax.legend(handles <span class="op">=</span> [ak_patch, kodiak_patch], frameon<span class="op">=</span><span class="va">False</span>, loc<span class="op">=</span><span class="st">'upper right'</span>)</span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="lesson-20-zonal-stats_files/figure-html/cell-8-output-1.png" width="579" height="353"></p>
</div>
</div>
</section>
<section id="dissolve-explode-polygons" class="level3" data-number="23.3.4">
<h3 data-number="23.3.4" class="anchored" data-anchor-id="dissolve-explode-polygons"><span class="header-section-number">23.3.4</span> Dissolve &amp; explode polygons</h3>
<p>The Kodiak data is too granular for our purposes: we want to get statistics on distance travelled on each fishing district.</p>
<div class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># check number of districts and rows</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"number of geometries: </span><span class="sc">{</span><span class="bu">len</span>(kodiak)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"number of districts: </span><span class="sc">{</span><span class="bu">len</span>(kodiak.district_name.unique())<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>number of geometries: 118
number of districts: 7</code></pre>
</div>
</div>
<p>We can aggregate the geometries based on the values of a column using the <code>dissolve()</code> method. In our case we will dissolve by district name:</p>
<div class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># dissolve by district</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="co"># as_index=False indicates we want to keep the "groupby" column as a column (not index)</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>districts <span class="op">=</span> kodiak[[<span class="st">'geometry'</span>,<span class="st">'district_name'</span>]].dissolve(by<span class="op">=</span><span class="st">'district_name'</span>, as_index<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>districts </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="9">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">district_name</th>
<th data-quarto-table-cell-role="th">geometry</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Afognak District</td>
<td>POLYGON ((83189.145 888000.815, 75313.997 8878...</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>Alitak Bay District</td>
<td>POLYGON ((-20595.210 769560.395, -20547.170 76...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>Eastside Kodiak District</td>
<td>MULTIPOLYGON (((-100710.109 633391.483, -10080...</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>Mainland District</td>
<td>MULTIPOLYGON (((-139689.424 797362.176, -14034...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>Northeast Kodiak District</td>
<td>POLYGON ((100175.379 849237.562, 100103.728 84...</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>Northwest Kodiak District</td>
<td>POLYGON ((9534.303 838682.678, 9542.565 838668...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>Southwest Kodiak District</td>
<td>POLYGON ((-31133.469 786483.521, -31127.360 78...</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Let’s take a look at the districts:</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Legend location
</div>
</div>
<div class="callout-body-container callout-body">
<p>We can control the legend location adding <code>loc</code> and <code>bbox_to_anchor</code> to the <code>legend_kwds</code>.</p>
<p>It can be useful to combine both of these to place the legend outside the graph:</p>
<ul>
<li><code>loc</code> indicates the corner of the legend box we want to locate, and</li>
<li><code>bbox_to_anchor</code> is a tuple with coordinates indicating where to place the corner specified in <code>loc</code>. Values between 0 and 1 are within the axes (the plot).</li>
</ul>
</div>
</div>
<div class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>districts.plot(column<span class="op">=</span><span class="st">'district_name'</span>, </span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>               legend<span class="op">=</span><span class="va">True</span>, </span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>               legend_kwds<span class="op">=</span>{<span class="st">'loc'</span>: <span class="st">"upper left"</span>, <span class="st">'bbox_to_anchor'</span>: (<span class="dv">1</span>, <span class="dv">1</span>)})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/Users/galaz-garcia/anaconda3/envs/mpc-env/lib/python3.11/site-packages/geopandas/plotting.py:732: FutureWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, CategoricalDtype) instead
  if pd.api.types.is_categorical_dtype(values.dtype):</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="10">
<pre><code>&lt;Axes: &gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="lesson-20-zonal-stats_files/figure-html/cell-11-output-3.png" width="588" height="425"></p>
</div>
</div>
<p>Notice the geometries of some our districts are multipolygons. To simplify our analysis for the purpose of this lesson we will separate each multipolygon into individual polygons. We can do this using the <code>explode()</code> method for <code>gpd.GeoDataFrames</code>:</p>
<div class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># explode polygons</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="co"># ignore_index=True resests the index so we don't get a multi-index</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>districts <span class="op">=</span> districts.explode(ignore_index<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>districts</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="11">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">district_name</th>
<th data-quarto-table-cell-role="th">geometry</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Afognak District</td>
<td>POLYGON ((83189.145 888000.815, 75313.997 8878...</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>Alitak Bay District</td>
<td>POLYGON ((-20595.210 769560.395, -20547.170 76...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>Eastside Kodiak District</td>
<td>POLYGON ((-100710.109 633391.483, -100806.993 ...</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>Eastside Kodiak District</td>
<td>POLYGON ((-14519.794 714624.553, -14616.441 71...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>Mainland District</td>
<td>POLYGON ((-139689.424 797362.176, -140346.100 ...</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>Mainland District</td>
<td>POLYGON ((-13390.443 922237.350, -13416.238 92...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>Northeast Kodiak District</td>
<td>POLYGON ((100175.379 849237.562, 100103.728 84...</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>Northwest Kodiak District</td>
<td>POLYGON ((9534.303 838682.678, 9542.565 838668...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>Southwest Kodiak District</td>
<td>POLYGON ((-31133.469 786483.521, -31127.360 78...</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
</section>
<section id="distance-raster-preparation" class="level2" data-number="23.4">
<h2 data-number="23.4" class="anchored" data-anchor-id="distance-raster-preparation"><span class="header-section-number">23.4</span> Distance raster preparation</h2>
<p>Now let’s move on to our raster.</p>
<section id="squeeze" class="level3" data-number="23.4.1">
<h3 data-number="23.4.1" class="anchored" data-anchor-id="squeeze"><span class="header-section-number">23.4.1</span> Squeeze</h3>
<p>First, we have an extra unnecessary dimension. Let’s get rid of it:</p>
<div class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># get rid of band dimension</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Before squeeze:</span><span class="ch">\n</span><span class="ss">dimensions </span><span class="sc">{</span>raw_dist<span class="sc">.</span>dims<span class="sc">}</span><span class="ss"> </span><span class="ch">\n</span><span class="ss">coords: </span><span class="sc">{</span>raw_dist<span class="sc">.</span>coords<span class="sc">}</span><span class="ss"> </span><span class="ch">\n</span><span class="ss">"</span>)</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>raw_dist <span class="op">=</span> raw_dist.squeeze().drop(<span class="st">'band'</span>)</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"After squeeze:</span><span class="ch">\n</span><span class="ss">dimensions </span><span class="sc">{</span>raw_dist<span class="sc">.</span>dims<span class="sc">}</span><span class="ch">\n</span><span class="ss">coords: </span><span class="sc">{</span>raw_dist<span class="sc">.</span>coords<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Before squeeze:
dimensions ('band', 'y', 'x') 
coords: Coordinates:
  * band         (band) int64 1
  * x            (x) float64 -2.55e+06 -2.549e+06 ... 5.347e+05 5.357e+05
  * y            (y) float64 2.711e+06 2.71e+06 ... 4.053e+05 4.043e+05
    spatial_ref  int64 0 

After squeeze:
dimensions ('y', 'x')
coords: Coordinates:
  * x            (x) float64 -2.55e+06 -2.549e+06 ... 5.347e+05 5.357e+05
  * y            (y) float64 2.711e+06 2.71e+06 ... 4.053e+05 4.043e+05
    spatial_ref  int64 0</code></pre>
</div>
</div>
</section>
<section id="updating-no-data-value" class="level3" data-number="23.4.2">
<h3 data-number="23.4.2" class="anchored" data-anchor-id="updating-no-data-value"><span class="header-section-number">23.4.2</span> Updating no-data value</h3>
<p>Take a look at the data:</p>
<div class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>raw_dist.plot()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="13">
<pre><code>&lt;matplotlib.collections.QuadMesh at 0x148d15350&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="lesson-20-zonal-stats_files/figure-html/cell-14-output-2.png" width="558" height="449"></p>
</div>
</div>
<p>The previous plot should make us think there are outliers or no-data values affecting the plot range. Let’s investigate this:</p>
<div class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># check min and max</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"min: </span><span class="sc">{</span>raw_dist<span class="sc">.</span><span class="bu">min</span>()<span class="sc">.</span>item()<span class="sc">:,}</span><span class="ss">, max: </span><span class="sc">{</span>raw_dist<span class="sc">.</span><span class="bu">max</span>()<span class="sc">.</span>item()<span class="sc">:,}</span><span class="ss">"</span>)</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="co"># get no-data value</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>nodata <span class="op">=</span> raw_dist.rio.nodata</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'no-data value'</span>, nodata)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>min: -3.3999999521443642e+38, max: 2,564,975.75
no-data value -3.4e+38</code></pre>
</div>
</div>
<p>We can select all pixels where there is raster data using the <a href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.where.html"><code>where()</code> method</a>. By default, <code>where()</code> will place <code>np.nan</code> (NAs) at every cell that does not satisty the condition.</p>
<div class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># select pixels with data using where()</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>raw_dist.where(raw_dist <span class="op">!=</span> nodata)</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a><span class="co"># transform no data values into nan (float)</span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>dist <span class="op">=</span> raw_dist.where(raw_dist <span class="op">!=</span> nodata)</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a><span class="co"># check updates</span></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f" min: </span><span class="sc">{</span>dist<span class="sc">.</span><span class="bu">min</span>()<span class="sc">.</span>item()<span class="sc">}</span><span class="ss">, max: </span><span class="sc">{</span>dist<span class="sc">.</span><span class="bu">max</span>()<span class="sc">.</span>item()<span class="sc">:,}</span><span class="ss">"</span>)</span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>dist.plot()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> min: 0.0, max: 2,564,975.75</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="15">
<pre><code>&lt;matplotlib.collections.QuadMesh at 0x148ee3050&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="lesson-20-zonal-stats_files/figure-html/cell-16-output-3.png" width="560" height="449"></p>
</div>
</div>
</section>
<section id="clipping" class="level3" data-number="23.4.3">
<h3 data-number="23.4.3" class="anchored" data-anchor-id="clipping"><span class="header-section-number">23.4.3</span> Clipping</h3>
<p>Since we are only focusing on the Kodiak district, let’s clip the raster to this region:</p>
<div class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># clip raster to Kodiak bounding box</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>kodiak_dist <span class="op">=</span> dist.rio.clip_box(<span class="op">*</span>districts.total_bounds)</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a><span class="co"># robust = True plots data within the 2th and 98th percentiles.</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>kodiak_dist.plot(robust<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="16">
<pre><code>&lt;matplotlib.collections.QuadMesh at 0x14935b610&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="lesson-20-zonal-stats_files/figure-html/cell-17-output-2.png" width="626" height="464"></p>
</div>
</div>
<p>Remember our goal is to calculate the total distance travelled in each district. We can take a look at the districts over the distance raster:</p>
<div class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># raster + districts plot</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots()</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>kodiak_dist.plot(ax<span class="op">=</span>ax, robust<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>districts.plot(ax<span class="op">=</span>ax, edgecolor<span class="op">=</span><span class="st">'red'</span>, color<span class="op">=</span><span class="st">'none'</span>)</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="lesson-20-zonal-stats_files/figure-html/cell-18-output-1.png" width="513" height="464"></p>
</div>
</div>
</section>
</section>
<section id="distance-in-a-single-district" class="level2" data-number="23.5">
<h2 data-number="23.5" class="anchored" data-anchor-id="distance-in-a-single-district"><span class="header-section-number">23.5</span> Distance in a single district</h2>
<p>A mask is a dataset that indicates which locations in the raster we will keep and which will be converted to NAs or, in our case, zeros. It is common to transform a polygon into a raster mask that selects all pixels that touch the polygon.</p>
<p><img src="../images/mask/mask.png" class="img-fluid"></p>
<p>To transform a geometry into a mask we can use the <code>rasterize()</code> function from <a href="https://rasterio.readthedocs.io/en/stable/api/rasterio.features.html"><code>rasterio.features</code></a>:</p>
<p><code>rasterio</code> is another popular Python library to work with rasters. Although many of its functions have been streamlined in <code>rioxarray</code>, there are still some that have not been replaced.</p>
<p>In the next cell we use the polygon for the Alitak district <code>districts.loc[1,'geometry']</code> to create a mask for the raster.</p>
<div class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create raster mask based on Alitak polygon</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>alitak_mask <span class="op">=</span> rasterize(shapes <span class="op">=</span> [districts.loc[<span class="dv">1</span>,<span class="st">'geometry'</span>]],  <span class="co"># a list of geometries</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>                        out_shape <span class="op">=</span> kodiak_dist.shape,           <span class="co"># shape of outout np array (shape of raster)</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>                        transform <span class="op">=</span> kodiak_dist.rio.transform(), <span class="co"># transformation of raster</span></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>                        all_touched <span class="op">=</span> <span class="va">True</span>)  <span class="co"># all pixels touched by geometries will be burned in </span></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">type</span>(alitak_mask))</span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a><span class="co"># print some info about mask</span></span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'mask shape: '</span>, alitak_mask.shape)</span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'same shape as raster? '</span>, alitak_mask.shape <span class="op">==</span> kodiak_dist.shape)</span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'unique values in mask'</span>, np.unique(alitak_mask))</span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a>plt.imshow(alitak_mask)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;class 'numpy.ndarray'&gt;
mask shape:  (352, 289)
same shape as raster?  True
unique values in mask [0 1]</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="18">
<pre><code>&lt;matplotlib.image.AxesImage at 0x148f7aed0&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="lesson-20-zonal-stats_files/figure-html/cell-19-output-3.png" width="357" height="416"></p>
</div>
</div>
<p>To select pixels from the raster using the mask we can simply multiply both rasters together.</p>
<p><img src="../images/mask/mask_raster.png" class="img-fluid"></p>
<div class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># apply mask to kodiak distances raster</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>dist_alitak <span class="op">=</span> kodiak_dist <span class="op">*</span> alitak_mask</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>dist_alitak.plot(robust<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="19">
<pre><code>&lt;matplotlib.collections.QuadMesh at 0x149244690&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="lesson-20-zonal-stats_files/figure-html/cell-20-output-2.png" width="617" height="464"></p>
</div>
</div>
<p>Finally, we can add up all the pixel values to obtain the total distance travelled by shipping vessels in Alitak:</p>
<div class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"total distance in Alitak: </span><span class="sc">{</span>dist_alitak<span class="sc">.</span><span class="bu">sum</span>()<span class="sc">.</span>item()<span class="sc">:,}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>total distance in Alitak: 5,606,546.5</code></pre>
</div>
</div>
<p>Doing the previous process in a single cell:</p>
<div class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># mask raster and calculate sum of pixels</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>alitak_mask <span class="op">=</span> rasterize([districts.loc[<span class="dv">1</span>,<span class="st">'geometry'</span>]],</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>                                    out_shape <span class="op">=</span> kodiak_dist.shape,</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>                                    transform <span class="op">=</span> kodiak_dist.rio.transform(),</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>                                    all_touched <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>dist_in_alitak <span class="op">=</span> (kodiak_dist <span class="op">*</span> alitak_mask).<span class="bu">sum</span>().item()</span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>dist_in_alitak</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="21">
<pre><code>5606546.5</code></pre>
</div>
</div>
</section>
<section id="distance-in-all-districts" class="level2" data-number="23.6">
<h2 data-number="23.6" class="anchored" data-anchor-id="distance-in-all-districts"><span class="header-section-number">23.6</span> Distance in all districts</h2>
<p>Once we have achieved a good workflow for a single district, it is easy to repeat it using a <code>for</code> loop:</p>
<div class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate distance per district polygon</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>distances <span class="op">=</span> []</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> districts.index:</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>    mask <span class="op">=</span> rasterize([districts.loc[i,<span class="st">'geometry'</span>]],</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>                              out_shape<span class="op">=</span>kodiak_dist.shape,</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>                              transform<span class="op">=</span>kodiak_dist.rio.transform(),</span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>                              all_touched<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>    dist_in_district <span class="op">=</span> (kodiak_dist <span class="op">*</span> mask).<span class="bu">sum</span>().item()</span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a>    distances.append(dist_in_district)</span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a>distances</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="22">
<pre><code>[9804045.0,
 5606546.5,
 102465.03125,
 22725528.0,
 4788347.0,
 673996.375,
 20008534.0,
 86952560.0,
 6666639.0]</code></pre>
</div>
</div>
<p>Then we can add the distances as a column in our <code>GeoDataFrame</code>:</p>
<div class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># add column with distance per district polygon</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>districts[<span class="st">'total_distance'</span>] <span class="op">=</span> distances</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>districts</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="23">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">district_name</th>
<th data-quarto-table-cell-role="th">geometry</th>
<th data-quarto-table-cell-role="th">total_distance</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Afognak District</td>
<td>POLYGON ((83189.145 888000.815, 75313.997 8878...</td>
<td>9.804045e+06</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>Alitak Bay District</td>
<td>POLYGON ((-20595.210 769560.395, -20547.170 76...</td>
<td>5.606546e+06</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>Eastside Kodiak District</td>
<td>POLYGON ((-100710.109 633391.483, -100806.993 ...</td>
<td>1.024650e+05</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>Eastside Kodiak District</td>
<td>POLYGON ((-14519.794 714624.553, -14616.441 71...</td>
<td>2.272553e+07</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>Mainland District</td>
<td>POLYGON ((-139689.424 797362.176, -140346.100 ...</td>
<td>4.788347e+06</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>Mainland District</td>
<td>POLYGON ((-13390.443 922237.350, -13416.238 92...</td>
<td>6.739964e+05</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>Northeast Kodiak District</td>
<td>POLYGON ((100175.379 849237.562, 100103.728 84...</td>
<td>2.000853e+07</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>Northwest Kodiak District</td>
<td>POLYGON ((9534.303 838682.678, 9542.565 838668...</td>
<td>8.695256e+07</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>Southwest Kodiak District</td>
<td>POLYGON ((-31133.469 786483.521, -31127.360 78...</td>
<td>6.666639e+06</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="acknowledgments" class="level2" data-number="23.7">
<h2 data-number="23.7" class="anchored" data-anchor-id="acknowledgments"><span class="header-section-number">23.7</span> Acknowledgments</h2>
<p>This lesson was adapted from the <a href="https://learning.nceas.ucsb.edu/2022-09-arctic/sections/10-geopandas.html">Spatial and Image Data Using GeoPandas</a> lesson from the NCEAS Scalable and Computationally Reproducible Approaches to Arctic Research workshop.</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../lectures/lesson-19-dem.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Raster manipulation I</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../discussion-sections/ds4-landcover.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">*Lab: land cover statistics</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>